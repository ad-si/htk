PACKAGE = uni-util
PACKAGES = concurrent lang data text uni-options

SRCS       = Queue.hs ExtendedPrelude.hs Computation.hs Dynamics.hs \
  WBFiles.hs Object.hs Debug.hs Maybes.hs LineShow.hs Cache.hs FileNames.hs \
  IOExtras.hs QuickReadShow.hs AtomString.hs SmallSet.hs Registry.hs \
  RegularExpression.hs DelSet.hs Thread.hs UniqueString.hs UniqueFile.hs \
  TempFile.hs Sink.hs VariableSet.hs VariableMap.hs \
  CommandStringSub.hs WaitOnN.hs FileSystem.hs PtrMagic.hs CacheTable.hs \
  DeepSeq.hs NameMangle.hs KeyedChanges.hs \
  Sources.hs Broadcaster.hs ReferenceCount.hs Delayer.hs VariableList.hs \
  Myers.hs VariableSetBlocker.hs IntPlus.hs UnionFind.hs BinaryIO.hs \
  ICStringLen.hs HGetCharHack.hs VisitedSet.hs StrError.hs \


SRCSC      = new_object.c default_options.c copy_file.c

SUBDIRS = test

include @TOP@/mk/boilerplate.mk

# We include special handling for defaultoptions when exporting.
prepareexportshere : changedefaultoptions

displaysrcshere : displayextrasrcs

displayextrasrcs :
	@echo @TOP@/util/default_options.default.c

.PHONY : changedefaultoptions displayextrasrcs

changedefaultoptions : 
	$(CCH) $(CFLAGS) -c default_options.default.c -o default_options.o
	$(AR) -r $(LIB) default_options.o  
	$(MAKE) packageherequick