#! This directory exists merely to be a pointer to the
#  current sources for HaXml.  We need to make an additional target,
#  lnsrcs, called from ./configure, which creates symbolic links to the
#  srcs in the HaXml directory. 


PACKAGE = uni-HaXml
PACKAGES = text data uni-util

HAXML = @TOP@/HaXml-1.09/src

# Disable DEBUG mode.  This is because Malcolm Wallace uses the same
# flag, and so if it's left it I get lots and lots of Malcolm's trace
# messages, which I don't want.
EXTRA_HC_OPTIONS += -UDEBUG


SRCS = $(HAXMLSRCS) XmlEscape.hs XmlFix.hs

# Taken from the setting for LIBSRCS in $(HAXML)/Makefile.in.
HAXMLSRCS = \
	Text/XML/HaXml.hs Text/XML/HaXml/Combinators.hs Text/XML/HaXml/Lex.hs \
	Text/XML/HaXml/Parse.hs Text/XML/HaXml/Pretty.hs \
	Text/XML/HaXml/Types.hs Text/XML/HaXml/Validate.hs \
	Text/XML/HaXml/Wrappers.hs Text/XML/HaXml/OneOfN.hs \
	Text/XML/HaXml/Xml2Haskell.hs Text/XML/HaXml/Haskell2Xml.hs \
	Text/XML/HaXml/Verbatim.hs \
	Text/XML/HaXml/Html/Generate.hs Text/XML/HaXml/Html/Parse.hs \
	Text/XML/HaXml/Html/Pretty.hs \
	Text/XML/HaXml/Xtract/Combinators.hs \
	Text/XML/HaXml/Xtract/Lex.hs \
	Text/XML/HaXml/Xtract/Parse.hs \
	Text/XML/HaXml/DtdToHaskell/Convert.hs \
	Text/XML/HaXml/DtdToHaskell/Instance.hs \
	Text/XML/HaXml/DtdToHaskell/TypeDef.hs \
	Text/ParserCombinators/HuttonMeijerWallace.hs \


include @TOP@/mk/boilerplate.mk

lnsrcs : 
	$(foreach file,$(HAXMLSRCS),\
           $(MKDIR) -p `dirname $(file)` \
           && $(LN) -s $(HAXML)/$(file) $(file) &&) \
        $(LN) -s $(HAXML)/tools/DtdToHaskell.hs tools/MainDtdToHaskell.hs && \
        echo "Don't copy again" >lnsrcs