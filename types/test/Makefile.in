PACKAGES = uni-types uni-htk uni-davinci

SRCS       = TestAttributeRepresentation.hs MainServer.hs MainWorkbench.hs \
   TestGetAttributesType.hs

EXTRAEXPORTS = Server berkeley_db_svc Makefile.in

include @TOP@/mk/boilerplate.mk

.PHONY : runServer runWorkbench killServer killWorkbench displayextrasrcs

prepareexports : Server berkeley_db_svc

displaysrcshere : displayextrasrcs

displayextrasrcs :
	@echo @TOP@/types/test/rerunWorkbench.in @TOP@/types/test/runWorkbench.in @TOP@/types/test/berkeley_db_svc



runServer : berkeley_db_svc
	@MKDIR@ -p /var/tmp/simpledb
	./berkeley_db_svc -h /var/tmp/simpledb &
	LD_LIBRARY_PATH=@BDBDIR@/lib:$$LD_LIBRARY_PATH ./Server --uni-debug=s.debug &

killServer :
	(pkill "^berkeley_db_svc$$" || echo not running)
	(pkill "^Server$$" || echo not running)
	rm -rf VersionGraph.backup storeDir /var/tmp/simpledb

runWorkbench :
	LD_LIBRARY_PATH=@BDBDIR@/lib:$$LD_LIBRARY_PATH ./Workbench --uni-debug=w.debug

killWorkbench :
	(pkill "^Workbench$$" || echo not running)
	rm -rf /tmp/#

berkeley_db_svc : $(BDBDIR)/bin/berkeley_db_svc
	rm -rf $@
	ln -sf $< $@
