#!/bin/sh

set -e

cd @TOP@/mmiss/test

# Check that files are here
TOP=@TOP@ @TOP@/mmiss/test/testfiles

# Test script for running the workbench.
export UNIEDITOR UNISERVERDIR UNIWORKINGDIR 

UNIEDITOR="@GNUCLIENT@ -eval '(setq stored-name \"%beN\")' \"%bF\""

UNISERVERDIR=${UNISERVERDIR:-`./TempDir /tmp/uni.$USER.server.`}
echo Using $UNISERVERDIR for the internal server.  Set UNISERVERDIR next time to reuse it.
UNIWORKINGDIR=${UNIWORKINGDIR:-`./TempDir /tmp/uni.$USER.working.`}

# The following variables have to be set since in the binary release they
# cannot (at the moment) be hardwired into the binaries.
export UNIWISH UNIDAVINCI UNIDAVINCIICONS UNIGNUCLIENT UNITOP UNIUSER UNIPASSWORD
UNIWISH=${UNIWISH:-@WISH@}
UNIDAVINCI=${UNIDAVINCI:-@DAVINCI@}
UNIDAVINCIICONS=${UNIDAVINCIICONS:-@TOP@/database/icons}
UNIGNUCLIENT=${UNIGNUCLIENT:-@GNUCLIENT@}
UNITOP=${UNITOP:-@TOP@}

gmake killWorkbench

gmake runWorkbench
