#!/bin/sh

set -e

cd @TOP@/mmiss/test

# Check that files are here
TOP=@TOP@ @TOP@/mmiss/test/testfiles

# Test script for running the workbench.
export UNIEDITOR UNISERVER UNISERVERDIR UNIWORKINGDIR UNIPORT

UNIEDITOR="@GNUCLIENT@ -eval '(setq stored-name \"%beN\")' \"%bF\""
UNISERVER=denebola.informatik.uni-bremen.de
# 11395 is used by the remote server.
UNIPORT=11395

UNISERVERDIR=${UNISERVERDIR:-`./TempDir /tmp/uni.$USER.server.`}
echo Using $UNISERVERDIR for the internal server.  Set UNISERVERDIR next time to reuse it.
UNIWORKINGDIR=${UNIWORKINGDIR:-`./TempDir /tmp/uni.$USER.working.`}

# The following variables have to be set since in the binary release they
# cannot (at the moment) be hardwired into the binaries.
export UNIWISH UNIDAVINCI UNIDAVINCIICONS UNIGNUCLIENT UNITOP UNIUSER UNIPASSWORD
UNIWISH=${UNIWISH:-@WISH@}
UNIDAVINCI=${UNIDAVINCI:-@DAVINCI@}
UNIDAVINCIICONS=${UNIDAVINCIICONS:-@TOP@/database/icons}
UNIGNUCLIENT=${UNIGNUCLIENT:-@GNUCLIENT@}
UNITOP=${UNITOP:-@TOP@}

gmake killWorkbench

gmake runWorkbench
