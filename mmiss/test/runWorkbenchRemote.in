#!/bin/sh

set -e

# Check that files are here
TOP=@TOP@ @TOP@/mmiss/test/testfiles

export UNISERVER UNIPORT UNIWORKINGDIR UNIEDITOR 



if test 0 -eq 1
then
   # we'll sort out how to do SSL forwarding when Matthias comes back ...

   UNISERVER=$HOSTNAME
   UNIPORT=11394
   REMOTESERVER=denebola.informatik.uni-bremen.de

   # If no-one is listening on 11394 connect this port up to the remote server.
   isConnected $UNISERVER 11394 || \
      xterm -title "SSH session to establish tunnel to $REMOTESERVER" -e \
         ssh2 -R 11394:$REMOTESERVER:11395 $REMOTESERVER &
else
   echo Insecure access done \(until Matthias gets back\)
   REMOTESERVER=denebola.informatik.uni-bremen.de
   UNISERVER=$REMOTESERVER
   UNIPORT=11395
fi


UNIEDITOR="@GNUCLIENT@ -eval '(setq stored-name \"%beN\")' \"%bF\""
UNISERVER=`hostname`
UNIWORKINGDIR=/tmp/uni.temp.$USER

# The following variables have to be set since in the binary release they
# cannot (at the moment) be hardwired into the binaries.
    export UNIWISH UNIDAVINCI UNIDAVINCIICONS UNIGNUCLIENT UNITOP 

UNIWISH=${UNIWISH:-@WISH@}
UNIDAVINCI=${UNIDAVINCI:-@DAVINCI@}
UNIDAVINCIICONS=${UNIDAVINCIICONS:-@TOP@/database/icons}
UNIGNUCLIENT=${UNIGNUCLIENT:-@GNUCLIENT@}
UNITOP=${UNITOP:-@TOP@}

gmake killWorkbench
gmake runWorkbench
